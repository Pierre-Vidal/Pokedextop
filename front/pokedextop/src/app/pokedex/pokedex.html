<div class="container mt-4">
  <h2 class="text-center mb-4">Ma Collection de Pokémon</h2>

  <!-- Message de chargement -->
  @if (isLoading) {
    <div class="text-center">
      <div class="spinner-border text-danger" role="status">
        <span class="visually-hidden">Chargement...</span>
      </div>
    </div>
  }

  <!-- Message si aucun Pokémon -->
  @if (!isLoading && myPokemons.length === 0) {
    <div class="alert alert-info text-center" role="alert">
      <h4>Votre collection est vide</h4>
      <p>Allez dans la liste des Pokémon pour ajouter des Pokémon à votre collection !</p>
    </div>
  }

  <!-- Barre de recherche et Liste des Pokémon -->
  @if (!isLoading && myPokemons.length > 0) {
    <!-- Search Bar -->
    <div class="row mb-4">
      <div class="col-md-6 mx-auto">
        <div class="input-group">
          <input
            type="text"
            class="form-control"
            placeholder="Rechercher dans ma collection..."
            [(ngModel)]="searchTerm"
            (ngModelChange)="onSearchChange()"
          >
          <button
            class="btn btn-outline-secondary"
            type="button"
            (click)="clearSearch()"
            [disabled]="!searchTerm"
          >
            Effacer
          </button>
        </div>
        <small class="text-muted d-block mt-2">
          {{filteredPokemons.length}} Pokémon(s) dans votre collection
        </small>
      </div>
    </div>

    <div class="row">
      <div class="col-md-4 mb-4" *ngFor="let pokemon of displayedPokemons">
        <div class="card pokemon-card text-center p-2 position-relative">
          <button
            class="btn btn-remove position-absolute"
            (click)="removePokemon(+pokemon.id)"
            title="Retirer de ma collection"
          >
            ✕
          </button>
          <img [src]="pokemon.image" class="card-img-top mx-auto" alt="{{pokemon.name}}">
          <div class="card-body">
            <h5 class="card-title">{{pokemon.name}}</h5>
            <p class="card-text">Height: {{pokemon.height}} | Weight: {{pokemon.weight}}</p>
            <div>
              <span *ngFor="let t of pokemon.type" class="type-badge {{t.toLowerCase()}}">{{t}}</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Pagination -->
    <nav aria-label="Page navigation">
      <ul class="pagination justify-content-center">
        <li class="page-item" [class.disabled]="currentPage === 1">
          <button class="page-link" (click)="prevPage()">Précédent</button>
        </li>

        <li
          class="page-item"
          *ngFor="let page of getPageNumbers()"
          [class.active]="currentPage === page"
        >
          <button class="page-link" (click)="goToPage(page)">{{page}}</button>
        </li>

        <li class="page-item" [class.disabled]="currentPage === totalPages">
          <button class="page-link" (click)="nextPage()">Suivant</button>
        </li>
      </ul>
    </nav>
  }
</div>
